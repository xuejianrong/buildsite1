(function(win) {
    var Tools = {
        WeixinPay: function(aParam, callback){
            function jsApiCall(){
                //调用微信JS api 支付
                WeixinJSBridge.invoke('getBrandWCPayRequest', JSON.parse(aParam), function(res){
                    if(res['err_msg'] == "get_brand_wcpay_request:ok" ) {
                        callback();
                    }else if(typeof UNotice != "undefined"){
                        UNotice.show('没有完成支付！');
                    }
                });
            }

            if (typeof WeixinJSBridge == "undefined"){
                if( document.addEventListener ){
                    document.addEventListener('WeixinJSBridgeReady', jsApiCall, false);
                }else if (document.attachEvent){
                    document.attachEvent('WeixinJSBridgeReady', jsApiCall);
                    document.attachEvent('onWeixinJSBridgeReady', jsApiCall);
                }

                if(typeof UNotice != "undefined"){
                    UNotice.show('支付组件初始中！');
                }
            }else{
                jsApiCall();
            }
        }
    };
    win.Tools = $.extend(win.Tools, Tools);
})(window);